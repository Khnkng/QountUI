<div>
  <div class="bill row" foundation>
    <div class="columns small-12 medium-12 large-12">
      <div class="row">
        <div class="columns small-12 medium-6 large-6 qount-form-backgorund">
          <form *ngIf="active" (ngSubmit)="submit($event)" novalidate [formGroup]="billForm">
            <span class="icon badge je-badge float-right" (click)="showMappingPage()" style="margin-left: 10px;margin-top: 5px;cursor:pointer;" [hidden]="!bill || newBill || currentState=='Enter'" >JE</span>
            <span class="label float-right" [hidden]="!bill || newBill" [ngClass]="getStatusClass(bill?.subState)">{{bill?.subState}}</span>
            <ul class="tabs bill-form-tabs" data-tabs id="bill-form-tabs">
              <li class="tabs-title is-active"><a href="#billDetails" aria-selected="true"><h6>Bill Details</h6></a></li>
              <li class="tabs-title"><a href="#lineDetails"><h6>Line Details</h6></a></li>
            </ul>
            <div class="tabs-content bill-form-tabs-content" data-tabs-content="bill-form-tabs" [hidden]="isBillLoading()">
              <div class="tabs-panel is-active" id="billDetails">
                <div class="bill-form-data" [ngStyle]="{'height':formHeight}" [hidden]="!companyID">
                  <div class="row" *ngIf="newBill">
                    <div class="small-12 medium-12 columns">
                      <label *ngIf="!(currentState=='Paid')">Bill Title
                        <div>
                          <input type="text" formControlName="title" placeholder="Bill Title*">
                          <div class="error" [hidden]="billForm.controls.title.untouched || billForm.controls.title.valid"><small>Bill Name is required.</small></div>
                        </div>
                      </label>
          s            <label *ngIf="currentState=='Paid'">Bill Title
                        <div>
                          <input type="text" formControlName="title" placeholder="Bill Title*" readonly>
                        </div>
                      </label>
                    </div>
                  </div>
                  <div class="row collapse">
                    <div class="small-12 medium-6 columns">
                      <div class="row">
                        <div class="small-12 medium-12 columns">
                          <label *ngIf="!(currentState=='Paid')">Bill Number
                            <div>
                              <input type="text" formControlName="billID" placeholder="Bill Number*" >
                              <div class="error" [hidden]="billForm.controls.billID.untouched || billForm.controls.billID.valid"><small>Bill Name is required.</small></div>
                            </div>
                          </label>
                          <label *ngIf="currentState=='Paid'">Bill Number
                            <div>
                              <input type="text" formControlName="billID" placeholder="Bill Number*" readonly>
                            </div>
                          </label>
                        </div>
                      </div>
                    </div>
                    <div class="small-12 medium-6 columns">
                      <label *ngIf="!(currentState=='Paid')">Vendor
                        <div >
                          <select formControlName="vendorName" placeholder="Vendor *" (change)="onVendorSelect($event.target.value)">
                            <option selected="selected" *ngFor="let vendor of vendors" value="{{vendor}}">{{vendor}}</option>
                          </select>
                          <div class="error" [hidden]="billForm.controls.vendorName.untouched || billForm.controls.vendorName.valid"><small>Enter vendor .</small></div>
                        </div>
                      </label>
                      <label *ngIf="currentState=='Paid'">Vendor
                        <div >
                          <select class="jeSelect" formControlName="vendorName" placeholder="Vendor *" (change)="onVendorSelect($event.target.value)" disabled>
                            <option selected="selected" *ngFor="let vendor of vendors" value="{{vendor}}">{{vendor}}</option>
                          </select>
                        </div>
                      </label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="columns small-12 medium-3 large-3">
                      <label *ngIf="!(currentState=='Paid')">PO Number
                        <div>
                          <input type="text" formControlName="poNumber" placeholder="PO Number">
                          <div class="error" [hidden]="billForm.controls.poNumber.untouched || billForm.controls.poNumber.valid"><small>Bill PO Number is required.</small></div>
                        </div>
                      </label>
                      <label *ngIf="currentState=='Paid'">PO Number
                        <div>
                          <input type="text" formControlName="poNumber" placeholder="PO Number" readonly>
                        </div>
                      </label>
                    </div>
                    <div class="columns small-12 medium-3 large-3">
                      <label *ngIf="!(currentState=='Paid')">Reference Number
                        <div>
                          <select formControlName="accountNumber" placeholder="Reference Number">
                            <option *ngFor="let accountNumber of accountNumbers" value="{{accountNumber}}">{{accountNumber}}</option>
                          </select>
                          <div class="error" [hidden]="billForm.controls.accountNumber.untouched || billForm.controls.accountNumber.valid"><small>Reference Number is required.</small></div>
                        </div>
                      </label>
                      <label *ngIf="currentState=='Paid'">Reference Number
                        <div>
                          <select class="jeSelect" formControlName="accountNumber" placeholder="Reference Number" disabled>
                            <option *ngFor="let accountNumber of accountNumbers" value="{{accountNumber}}">{{accountNumber}}</option>
                          </select>
                        </div>
                      </label>
                    </div>
                    <div class="columns small-12 medium-3 large-3">
                      <label *ngIf="!(currentState=='Paid')">Currency
                        <div>
                          <select formControlName="currency" placeholder="currency" (change)="onCurrencySelect($event.target.value)">
                            <option *ngFor="let currency of currencies" value="{{currency}}">{{currency}}</option>
                          </select>
                          <div class="error" [hidden]="billForm.controls.currency.untouched || billForm.controls.currency.valid"><small>Select one</small></div>
                        </div>
                      </label>
                      <label *ngIf="currentState=='Paid'">Currency
                        <div>
                          <select class="jeSelect" formControlName="currency" placeholder="currency" (change)="onCurrencySelect($event.target.value)" disabled>
                            <option *ngFor="let currency of currencies" value="{{currency}}">{{currency}}</option>
                          </select>
                        </div>
                      </label>
                    </div>
                    <div class="columns small-12 medium-3 large-3">
                      <label *ngIf="!(currentState=='Paid')">Bill Date
                        <div>
                          <input type="text" custom-datepicker [format]="MM/DD/YYYY" [mindate]="'past'" (valueChanged)="setBillDate($event)" formControlName="billDate" placeholder="Bill Date*">
                          <div class="error" [hidden]="billForm.controls.billDate.untouched || billForm.controls.billDate.valid"><small>Enter Bill date.</small></div>
                        </div>
                      </label>
                      <label *ngIf="currentState=='Paid'">Bill Date
                        <div>
                          <input type="text" formControlName="billDate" readonly>
                        </div>
                      </label>
                    </div>
                  </div>
                  <div class="row collapse">
                    <div class="columns small-12 medium-6 large-6">
                      <div class="row ">
                        <div class="columns small-12 medium-6 large-6">
                          <label *ngIf="!(currentState=='Paid')">Terms
                            <div>
                              <select formControlName="term" placeholder="Terms" (change)="selectTerm($event.target.value)">
                                <option [value]="'net30'">Net 30</option>
                                <option [value]="'net45'">Net 45</option>
                                <option [value]="'net60'">Net 60</option>
                                <option [value]="'net30'">Net 90</option>
                                <option [value]="'custom'">Custom</option>
                              </select>
                              <div class="error" [hidden]="billForm.controls.term.untouched || billForm.controls.term.valid"><small>Select Term</small></div>
                            </div>
                          </label>
                          <label *ngIf="currentState=='Paid'">Terms
                            <div>
                              <select class="jeSelect" formControlName="term" placeholder="Terms" (change)="selectTerm($event.target.value)" disabled>
                                <option [value]="'net30'">Net 30</option>
                                <option [value]="'net45'">Net 45</option>
                                <option [value]="'net60'">Net 60</option>
                                <option [value]="'net30'">Net 90</option>
                                <option [value]="'custom'">Custom</option>
                              </select>
                            </div>
                          </label>
                        </div>
                        <div class="columns small-12 medium-6 large-6">
                          <label *ngIf="!(currentState=='Paid')">Due Date
                            <div>
                              <input type="text" [disabled]="billForm.controls.term.value != 'custom'" *ngIf="billForm.controls.term.value != 'custom'"  formControlName="dueDate" placeholder="Due Date*">
                              <input type="text" *ngIf="billForm.controls.term.value == 'custom'" [mindate]="billForm.controls.billDate.value" custom-datepicker [format]="MM/DD/YYYY" (valueChanged)="setDueDate($event)" formControlName="dueDate" placeholder="Due Date*">
                              <div class="error" [hidden]="billForm.controls.dueDate.untouched || billForm.controls.dueDate.valid"><small>Enter due date.</small></div>
                            </div>
                          </label>
                          <label *ngIf="currentState=='Paid'">Due Date
                            <div>
                              <input type="text" formControlName="dueDate" placeholder="Due Date*" readonly>
                            </div>
                          </label>

                        </div>
                      </div>
                    </div>
                    <div class="small-12 medium-6 columns">
                      <div class="row">
                        <div class="columns small-12 medium-6 large-6">
                          <label *ngIf="!(currentState=='Paid')">Recurring
                            <div >
                              <select formControlName="recurring" placeholder="Recurring*">
                                <option value="onlyonce">Once</option>
                                <option value="weekly">Weekly</option>
                                <option value="monthly">Monthly</option>
                                <option value="quarterly">Quarterly</option>
                              </select>
                              <div class="error" [hidden]="billForm.controls.recurring.untouched || billForm.controls.recurring.valid"><small>Select one</small></div>
                            </div>
                          </label>
                          <label *ngIf="currentState=='Paid'">Recurring
                            <div >
                              <select class="jeSelect" formControlName="recurring" placeholder="Recurring*" disabled>
                                <option value="onlyonce">Once</option>
                                <option value="weekly">Weekly</option>
                                <option value="monthly">Monthly</option>
                                <option value="quarterly">Quarterly</option>
                              </select>
                            </div>
                          </label>
                        </div>
                        <div class="small-12 medium-6 columns"  *ngIf="billForm.controls.recurring.value != 'onlyonce' && billForm.controls.recurring.value != null">
                          <label *ngIf="!(currentState=='Paid')">End Date
                            <div>
                              <input type="text" custom-datepicker [format]="MM/DD/YYYY" (valueChanged)="setEndDate($event)" formControlName="endDate" placeholder="End Date*">
                              <div class="error" [hidden]="billForm.controls.endDate.untouched || billForm.controls.endDate.valid"><small>Enter end date.</small></div>
                            </div>
                          </label>
                          <label *ngIf="currentState=='Paid'">End Date
                            <div>
                              <input type="text" formControlName="endDate" placeholder="End Date*" readonly>
                            </div>
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row  collapse">

                    <div class="columns small-12 medium-12 ">
                      <div class="row">
                        <div class="columns small-12 medium-6 " >
                          <label  *ngIf="tabId!=3&&!newBill&&!(currentState=='Paid')"><input type="checkbox" formControlName="hasPaidApplied" (change)="hasMarkPaidApplied()"> Mark Paid
                          </label>
                        </div>
                        <div class="columns small-12 medium-6  text-right">
                          <label>Bill Amount: {{billForm.controls.amount.value| currency:displayCurrency:true:'1.2-2'}}
                          </label>
                          <label *ngIf="show1099">1099 Amount: {{billForm.controls._1099Amount.value| currency:displayCurrency:true:'1.2-2'}}
                          </label>
                          <label *ngIf="showConvertedCurrency">Bill Amount ({{companyCurrency}}): {{companyCurrencyAmount| currency:companyCurrency:true:'1.2-2'}}
                          </label>
                          <label *ngIf="showConvertedCurrency">
                            Conversion Rate ({{defaultConversionAmount | currency:displayCurrency:true:'1.2-2'}} = {{convertedAmount| currency:companyCurrency:true:'1.2-2'}})
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row collapse">
                    <div class="small-12 columns medium-12 large-12">
                      <label *ngIf="isCurrentUser()&&havingChecklist">Check List
                        <div class="row" formArrayName="checkList">
                          <div class="column small-12 medium-12 large-12" *ngFor="let checkListItem of billForm.controls.checkList.controls;let index=index;">
                            <div [formGroupName]="index">
                              <label attr.for="checklistid-{{index}}"><input id="checklistid-{{index}}" [formControl]="checkListItem.controls.acknowledged" type="checkbox" required> {{checkListItem.controls.item.value}}</label>

                            </div>
                            <div class="error" [hidden]="billForm.controls.checkList.controls[index].controls.acknowledged.untouched || billForm.controls.checkList.controls[index].controls.acknowledged.value">
                              <small>{{checkListItem.controls.item.value}} is required.</small>
                            </div>
                          </div>
                        </div>
                      </label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="tabs-panel" id="lineDetails" [hidden]="isBillLoading()" foundation>
                <div class="bill-form-data" [ngStyle]="{'height':formHeight}">
                  <div class="row collapse">
                    <div class="small-12 columns">
                      <div class="row">
                        <div class="small-12 medium-12 columns">
                          <label>Lines</label>
                          <div class="dropdown-values" style="overflow: auto;">
                            <table class="stack">
                              <thead>
                              <tr>
                                <th width="18%">Quantity</th>
                                <th width="18%">Unit Price</th>
                                <th width="18%">Amount</th>
                                <th width="18%">Item Code</th>
                                <th width="18%">Account Code</th>
                                <th></th>
                              </tr>

                              </thead>
                              <tbody>
                              <tr *ngFor="let lineListItem of billForm.controls.lines.controls;let index=index;" [hidden]="lineListItem.controls.destroy.value" (click)="editLine(lineListItem, index)">
                                <td [hidden]="lineListItem.editable">{{lineListItem.controls.quantity.value?lineListItem.controls.quantity.value:null}}</td>
                                <td [hidden]="!lineListItem.editable">
                                  <input id="linelistQuantity-{{index}}" [formControl]="lineListItem.controls.quantity" type="text" (keyup)="calcAmount($event, lineListItem)" (change)="calcAmount($event, lineListItem)"/>
                                </td>
                                <td [hidden]="lineListItem.editable">{{lineListItem.controls.unitPrice.value?(lineListItem.controls.unitPrice.value| currency:displayCurrency:true:'1.2-2'):null}}</td>
                                <td [hidden]="!lineListItem.editable">
                                  <input id="linelistUnitPrice-{{index}}" [formControl]="lineListItem.controls.unitPrice" type="text" numeral [format]="'$0,0.00'" [locale]="displayCurrency" (keyup)="calcAmount($event, lineListItem)" (change)="calcAmount($event, lineListItem)"/>
                                </td>
                                <td [hidden]="lineListItem.editable">{{lineListItem.controls.amount.value?(lineListItem.controls.amount.value| currency:displayCurrency:true:'1.2-2'):(0|number : '1.2-2')}}</td>
                                <td [hidden]="!lineListItem.editable">
                                  <input id="linelistAmount-{{index}}" disabled [formControl]="lineListItem.controls.amount" type="text" numeral [format]="'$0,0.00'" [locale]="displayCurrency"/>
                                </td>
                                <td class="truncate" [hidden]="lineListItem.editable">{{lineListItem.controls.itemCode.value}}</td>
                                <td [hidden]="!lineListItem.editable">
                                  <select id="linelistItemCode-{{index}}" [formControl]="lineListItem.controls.itemCode" placeholder="Item Code">
                                    <option value="">-None-</option>
                                    <option *ngFor="let itemCode of itemCodes" value="{{itemCode.name}}">{{itemCode.name}}</option>
                                  </select>
                                </td>
                                <td class="truncate" [hidden]="lineListItem.editable">{{lineListItem.controls.expenseCode.value}}</td>
                                <td [hidden]="!lineListItem.editable">
                                  <select id="linelistExpenseCode-{{index}}" [formControl]="lineListItem.controls.expenseCode" placeholder="Account Code">
                                    <option value="">-None-</option>
                                    <option *ngFor="let expenseCode of expenseCodes" value="{{expenseCode.name}}">{{expenseCode.name}}</option>
                                  </select>
                                </td>
                                <td>
                                  <i class="icon ion-edit" (click)="showFlyout('UPDATE', index)"></i>
                                  <i class="icon ion-ios-trash-outline" *ngIf="getLineCount() > 1" (click)="deleteLine($event, index)"></i>
                                </td>
                              </tr>
                              </tbody>
                            </table>
                          </div>
                          <div class="text-right">
                            <label>Bill Amount :
                              {{billForm.controls.amount.value| currency:displayCurrency:true:'1.2-2'}}
                            </label>
                          </div>
                          <div class="text-right" *ngIf="show1099">
                            <label>1099 Amount :
                              {{billForm.controls._1099Amount.value| currency:displayCurrency:true:'1.2-2'}}
                            </label>
                          </div>

                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row" [hidden]="isBillLoading()">
              <div class="small-12 medium-12 columns" *ngIf="!newBill">
                <button class="button create small warning" [disabled]="!isCurrentUser() || bill.currentState == 'Enter'"
                        type="submit" (click)="submit($event, 'reject')">Reject</button>
                <button *ngIf="currentState=='Pay'" class="button create small success"
                        [disabled]="!billForm.valid || !hasCheckedAll() || !isCurrentUser()"
                        (click)="submitPay($event)">Submit</button>
                <button *ngIf="!(currentState=='Pay')" class="button create small success"
                        [disabled]="!billForm.valid || !hasCheckedAll() || !isCurrentUser()"
                        type="submit" (click)="submit($event, 'submit')">Submit</button>
                <button class="button create small" [disabled]="!isCurrentUser()" style="margin-right:10px;" type="submit"
                        (click)="submit($event)">Save</button>
              </div>
              <div class="small-12 medium-12 columns"  *ngIf="newBill">
                <button *ngIf="newBill" class="button create small" [disabled]="!billForm.valid || !hasCheckedAll()"
                        type="submit" (click)="submit($event, 'newBill')">Save</button>
                <button *ngIf="!(currentState=='Pay')" class="button create small success" [disabled]="!billForm.valid || !hasCheckedAll()"
                        type="submit" (click)="submit($event, 'submit')">Submit</button>
              </div>
            </div>
          </form>


          <div class="reveal tiny bill-modal-container" id="TagsModal" data-reveal>
            <div class="row collapse">
              <div class="small-12 columns">
                <label>Notes
                  <div>
                    <textarea rows="4" type="text" [(ngModel)]="notes" placeholder="Bill Notes"></textarea>
                  </div>
                </label>
              </div>
            </div>

            <button class="close-button" data-close aria-label="Close modal" type="button">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>

          <div class="reveal tiny bill-modal-container" id="NotesModal" data-reveal>

            <div class="row collapse">
              <div class="small-12 columns">
                <label>Tags
                  <div *ngIf="loaded || newBill">
                    <ul class="bighalf-tags" id="mainTags" type="text" [tagsList]="billTags" custom-tags></ul>
                  </div>
                </label>
              </div>
            </div>
            <button class="close-button" data-close aria-label="Close modal" type="button">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>

        </div>
        <div class="columns small-12 medium-6 large-6">
          <div class="bill-container">
            <div class="row collapse">
              <div class="column small-12 medium-12 large-12">
                <ul foundation class="accordion" data-accordion data-allow-all-closed="true" *ngIf="!newBill">
                  <li data-accordion-item class="accordion-item">
                    <a class="accordion-title" style="height: 55px;">
                      <div>
                        <strong class="float-left" [hidden]="editingName">
                          {{bill?.name}}
                          <i class="icon ion-edit" (click)="editName($event)"></i>
                        </strong>
                        <input type="text" [focus]="editingName" [(ngModel)]="newName" [hidden]="!editingName" style="height: 25px; width: 150px; float: left;"/>
                        <i class="ion-ios-checkmark-outline save-row-icon float-left" style="font-size: 21px; margin-left: 5px;" [hidden]="!editingName" (click)="updateName($event)"></i>
                      </div>
                      <span class="bill-preview-icons float-right">
                          <i data-open="TagsModal" data-tooltip aria-haspopup="true" class="" data-disable-hover="false"  title="Notes"  class="icon ion-compose top"></i>
                          <i data-open="NotesModal" data-tooltip aria-haspopup="true" class="" data-disable-hover="false"  title="Tags"  class="icon ion-ios-pricetags  top"></i>
                          <a title="download" *ngIf="billFileExist" target="_blank" href="{{downloadLink}}" (click)="stopPropagation($event)"><i  data-tooltip aria-haspopup="true" class="" data-disable-hover="false"  title="Download" class="icon ion-ios-cloud-download top"></i></a>
                      </span>
                    </a>
                    <div class="accordion-content" data-tab-content [hidden]="!billFileExist">
                      <div *ngIf="bill && billFileExist" class="bill-container" foundation>
                        <div class="bill-preview-container" [ngStyle]="{'max-height':tabHeight}" >
                          <img *ngIf="!isPdf" [src]="billImageLink" width="100%" />
                        </div>

                        <!--<embed *ngIf="isPdf" [src]="billLink" width="100%" height="400px;" pluginspage="http://www.adobe.com/products/acrobat/readstep2.html">-->
                        <div *ngIf="isPdf">
                          <iframe [src]="billPdfLink" [ngStyle]="{'width':'100%', 'height':tabHeight}" frameborder="0"></iframe>
                        </div>
                        <div style="margin-top:5px;float:right;">
                          <a title="Delete Document" target="_blank" (click)="deleteDocument()"><i style="color:#6f7f8f;" data-tooltip aria-haspopup="true" class="" data-disable-hover="false"  title="Delete Documents" class="icon ion-trash-b top"></i></a>
                        </div>
                      </div>
                      <div *ngIf="!bill">
                        <h5 style="margin-top:10px;">Loading the bill..</h5>
                      </div>
                    </div>
                  </li>
                  <li data-accordion-item class="accordion-item">
                    <a class="accordion-title">Bill History - {{bill ? (bill.history ? bill.history[0] : "" ) : ""}}</a>
                    <div class="accordion-content" data-tab-content>
                      <div class="dropdown-values">
                        <div class="dropdown-value-item" *ngFor="let historyItem of bill?.history;let index=index">
                          {{historyItem}}
                        </div>
                      </div>
                    </div>
                  </li>
                </ul>
                <ul foundation class="accordion" data-accordion data-allow-all-closed="true" *ngIf="newBill && billFileExist">
                  <li data-accordion-item class="accordion-item">
                    <a class="accordion-title" style="height: 55px;">
                      <div>
                        <strong class="float-left" [hidden]="editingName">
                          {{bill?.name}}
                          <i class="icon ion-edit" (click)="editName($event)"></i>
                        </strong>
                        <input type="text" [focus]="editingName" [(ngModel)]="newName" [hidden]="!editingName" style="height: 25px; width: 150px; float: left;"/>
                        <i class="ion-ios-checkmark-outline save-row-icon float-left" style="font-size: 21px; margin-left: 5px;" [hidden]="!editingName" (click)="updateName($event)"></i>
                      </div>
                      <span class="bill-preview-icons float-right">
                          <i data-open="TagsModal" data-tooltip aria-haspopup="true" class="" data-disable-hover="false"  title="Notes"  class="icon ion-compose top"></i>
                          <i data-open="NotesModal" data-tooltip aria-haspopup="true" class="" data-disable-hover="false"  title="Tags"  class="icon ion-ios-pricetags  top"></i>
                          <a title="download" *ngIf="billFileExist" target="_blank" href="{{downloadLink}}" (click)="stopPropagation($event)"><i  data-tooltip aria-haspopup="true" class="" data-disable-hover="false"  title="Download" class="icon ion-ios-cloud-download top"></i></a>
                      </span>
                    </a>
                    <div class="accordion-content" data-tab-content [hidden]="!billFileExist">
                      <div *ngIf="bill && billFileExist" class="bill-container" foundation>
                        <div class="bill-preview-container" [ngStyle]="{'max-height':tabHeight}" >
                          <img *ngIf="!isPdf" [src]="billImageLink" width="100%" />
                        </div>

                        <!--<embed *ngIf="isPdf" [src]="billLink" width="100%" height="400px;" pluginspage="http://www.adobe.com/products/acrobat/readstep2.html">-->
                        <div *ngIf="isPdf">
                          <iframe [src]="billPdfLink" [ngStyle]="{'width':'100%', 'height':tabHeight}" frameborder="0"></iframe>
                        </div>
                        <div style="margin-top:5px;float:right;">
                          <a title="Delete Document" target="_blank" (click)="deleteDocument()"><i style="color:#6f7f8f;" data-tooltip aria-haspopup="true" class="" data-disable-hover="false"  title="Delete Documents" class="icon ion-trash-b top"></i></a>
                        </div>
                      </div>
                      <div *ngIf="!bill">
                        <h5 style="margin-top:10px;">Loading the bill..</h5>
                      </div>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
            <div *ngIf="newBill || (bill && !billFileExist)">
              <section>
                <div class="file-upload-modal">
                  <div class="header">
                    <strong>Upload a Bill document</strong>
                  </div>

                  <section class="upload-area"  ng2FileDrop [uploader]="uploader" (fileOver)="fileOverBase($event)" >
                    <div class="row upload-choose-btn" [ngClass]="{'popup-file-over': hasBaseDropZoneOver}">
                      <div class="column text-center">
                        <label for="nativeFileUpload" class="button">Choose File</label>
                        <input type="file" id="nativeFileUpload" (change)="startUpload($event)" value="null" class="show-for-sr" ng2FileSelect [uploader]="uploader" />
                        <p>Drag and drop files here.</p>
                      </div>
                    </div>
                    <div class="row files-to-upload-section">
                      <ul *ngIf="uploader.queue.length>0">
                        <li *ngFor="let item of uploader.queue">
                          <div class="row">
                            <div class="column small-10" [ngClass]="{'item-uploaded':item.isSuccess}">
                              <span *ngIf="!(item.isReady || item.isUploading || item.isSuccess)">
                                <i class="ion-ios-cloud-upload-outline" (click)="item.upload()"></i>
                              </span>
                              {{ item?.file?.name }} &nbsp;({{ item?.file?.size/1024/1024 | number:'.2' }} MB)
                            </div>
                            <div class="column small-2 text-right">
                              <i *ngIf="(item.isUploading)" class="ion-ios-close-outline" (click)="item.cancel()"></i>
                              <i class="ion-ios-minus-outline" (click)="removeUploadItem(item)"></i>
                            </div>
                          </div>
                          <div *ngIf="item.isUploading">
                            <div class="progress">
                              <div class="progress-meter" [ngStyle]="{ 'width': item.progress + '%' }"></div>
                            </div>
                          </div>
                        </li>
                      </ul>
                    </div>
                  </section>
                </div>
              </section>
            </div>
          </div>
          <div class="comments-box" [hidden]="!showComments">
            <div class="comments-header">
              <span class="comments-title">Comments</span>
            </div>
            <div class="comments-body">
              <div class="comment" *ngFor="let comment of billComments">
                <div>
                 <span class="comment-content">
                   <span class="recipient" *ngFor="let name of comment.mentions_name">@{{name}}</span>
                   {{comment.comment}}
                 </span>
                </div>
                <div class="commented-by-cont">
                  <span class="commented-by">{{comment.user}} | {{ comment.dateTime | date:'medium'}}</span>
                </div>
              </div>
            </div>
            <div class="comments-footer">
              <recipient-input (entered)="onEnter($event)"></recipient-input>
            </div>
          </div>
          <div class="overlay" [hidden]="!showOverlay">
          </div>
        </div>
      </div>
    </div>
    <div class="report-wrapper journal-flyout">
      <div class="sidenav customization-panel" [ngClass]="dimensionFlyoutCSS" foundation>
        <form *ngIf="lineActive" novalidate [formGroup]="lineForm">
          <div class="row collapse dimension-flyout">
            <div class="row">
              <div class="small-12 medium-6 columns">
                <div class="row">
                  <div class="column small-12 medium-12 large-6">
                    <label>
                      Description
                      <textarea rows="4" formControlName="description" placeholder="Description">
                      </textarea>
                    </label>
                  </div>
                  <div class="column small-12 medium-12 large-6">
                    <div class="row">
                      <div class="small-12 medium-12">
                        <label>
                          Quantity
                          <input type="text" formControlName="quantity" placeholder="Quantity" (keyup)="calcAmount($event, lineForm)" (change)="calcAmount($event, lineForm)">
                        </label>
                      </div>
                      <div class="small-12 medium-12">
                        <label>
                          Unit Price
                          <input type="text" formControlName="unitPrice" numeral [format]="'$0,0.00'" [locale]="billForm.controls.currency.value" placeholder="Unit Price" (keyup)="calcAmount($event, lineForm)" (change)="calcAmount($event, lineForm)">
                        </label>
                      </div>
                    </div>

                  </div>
                  <div class="column small-12 medium-6 large-6">
                    <label>
                      Amount
                      <input type="text" formControlName="amount" placeholder="Amount" disabled numeral [format]="'$0,0.00'" [locale]="billForm.controls.currency.value"/>
                    </label>
                  </div>
                  <div class="column small-12 medium-6 large-6">
                    <label>
                      Item Code
                      <select formControlName="itemCode" placeholder="Item Code" (change)="displayItemCodeCOA($event.target.value)">
                        <option value="">-None-</option>
                        <option *ngFor="let itemCode of itemCodes" value="{{itemCode.name}}">{{itemCode.name}}</option>
                      </select>
                    </label>
                  </div>
                  <div class="column small-12 medium-6 large-6">
                    <label>
                      Expense Code
                      <select formControlName="expenseCode" placeholder="Account Code" (change)="displayExpenseCodeCOA($event.target.value)">
                        <option value="">-None-</option>
                        <option *ngFor="let expenseCode of expenseCodes" value="{{expenseCode.name}}">{{expenseCode.name}}</option>
                      </select>
                    </label>
                  </div>
                  <div class="column small-12 medium-6 large-6" *ngIf="show1099">
                    <label>
                      1099 Reportable
                      <input  formControlName="has1099" type="checkbox">
                    </label>
                  </div>
                  <div class="column small-12 medium-6 large-6" *ngIf="show1099">
                    <label>
                      1099 Mapping
                      <select formControlName="_1099Mapping" placeholder="1099 Mapping">
                        <option *ngFor="let _1099Code of _1099Codes" value="{{_1099Code}}">{{_1099Code}}</option>
                      </select>
                    </label>
                  </div>
                  <div class="column small-12 medium-6 large-6">
                    <label class="coa-description" [hidden]="!paymentCOAName">
                      <span>Payment COA:</span> {{paymentCOAName}}
                    </label>
                    <label class="coa-description" [hidden]="!expenseCOAName">
                      <span>Expense COA:</span> {{expenseCOAName}}
                    </label>
                  </div>
                </div>
              </div>
              <div class="small-12 medium-6 columns">
                <label>Dimensions
                  <div class="row dimension-grids" (click)="doNothing($event)">
                    <div class="small-12 medium-4 columns dimension-grid" *ngFor="let dimension of dimensions">
                      <div class="dimension-header">
                        <div>
                          <span class="float-left">{{dimension.name}}</span>
                          <span class="float-right">
                              <i class="icon ion-checkmark-circled" [ngClass]="{'selected': isDimensionSelected(dimension.name)}"
                                 (click)="selectDimension($event, dimension.name)"></i>
                          </span>
                        </div>
                        <div class="bottom" [ngClass]="{'selected': isDimensionSelected(dimension.name)}"></div>
                      </div>
                      <div class="dimension-values" [ngClass]="{'selected': isDimensionSelected(dimension.name)}">
                        <div class="dimension-value" *ngFor="let value of dimension.values; let index = index;">
                          <label (click)="selectValue($event, dimension, value)">
                            <input type="checkbox" [checked]="isValueSelected(dimension, value)"/>{{value}}
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>
                </label>
              </div>
            </div>
            <div class="row" *ngIf="!(currentState=='Paid')">
              <div class="small-12 medium-12 columns">
                <input type="button" class="button small float-right" value="Save" (click)="saveLine()"/>
              </div>
            </div>
            <div class="row" *ngIf="currentState=='Paid'">
              <div class="columns">
                <span class="label float-right vew-only"  ><i class="icon ion-edit"></i>View Only</span>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
    <div class="comment-link">
      <a data-tooltip (click)="showComments = !showComments;"  title="Comments">
        <i class="icon" [ngClass]="{'ion-chatbubble-working':!showComments, 'ion-ios-close-empty':showComments}"></i></a>
    </div>
    <div class="qount-off-canvas-menu">
      <div class="flyout expanded" [ngClass]="{'expanded':showMarkPaidFlyout}">
        <section class="flyout-placeholder">
          <header class="flyout-header">
            <h6> Enter Payment Details</h6>
          </header>
          <div class="flyout-body flyout-shadow-effect">
            <!--here comes actual flyout code-->
            <div class="create-vendor">
              <div *ngIf="showMarkPaidFlyout">
                <section class="form-section clearfix">
                  <div class="row">
                    <div class="small-12 medium-12 columns">
                      <div class="form-section-left">
                        <header class="form-section-header">Payment Details</header>
                        <div class="row">
                          <div class="small-4 columns">
                            <label class="text-right">Payment Title</label>
                          </div>
                          <div class="small-6 columns">
                            <input type="text" [(ngModel)]="paidBill.title" placeholder="Payment Title*">
                          </div>
                        </div>
                        <div class="row">
                          <div class="small-4 columns">
                            <label class="text-right">Payment method</label>
                          </div>
                          <div class="small-6 columns">
                            <select placeholder="Payment Method" [(ngModel)]="paidBill.payMethod">
                              <option [value]="">-None-</option>
                              <option [value]="'ach'">ACH</option>
                              <option [value]="'digitalCheque'">Digital Check</option>
                              <option [value]="'mailCheque'">Physical Check</option>
                            </select>
                          </div>
                        </div>
                        <div class="row">
                          <div class="small-4 columns">
                            <label class="text-right" >Bank</label>
                          </div>
                          <div class="small-6 columns custom-qount-form-field">
                            <select combo-box #bankAccountsComboBoxDir="comboBox" title="" data-placeholder="Enter Account" [listObject]="companyAccounts" (valueChanged)="onBankSelect($event)" [(ngModel)]="paidBill.bankAccountID">
                              <option *ngFor="let account of companyAccounts" [value]="account.name">{{account.name}}</option>
                            </select>
                          </div>
                        </div>
                        <div class="row">
                          <div class="small-4 columns">
                            <label class="text-right">Bill Payment Number</label>
                          </div>
                          <div class="small-6 columns">
                            <input type="text" [(ngModel)]="paidBill.payNumber" placeholder="Payment Number*">
                          </div>
                        </div>
                      </div>
                      <div class="form-section-left">
                        <header class="form-section-header">.</header>
                        <div class="row">
                          <div class="small-4 columns">
                            <label class="text-right" >Pay Date</label>
                          </div>
                          <div class="small-6 columns">
                            <input type="text" [mindate]="'past'" [(ngModel)]="paidBill.payDate" custom-datepicker [format]="MM/DD/YYYY" (valueChanged)="setMarkPaidDate($event)"  placeholder="Pay Date*">
                          </div>
                        </div>
                        <div class="row">
                          <div class="small-4 columns">
                            <label class="text-right" >Notes</label>
                          </div>
                          <div class="small-6 columns">
                            <textarea rows="3" [(ngModel)]="paidBill.notes" placeholder="Notes*"></textarea>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="small-12 medium-12 columns">
                      <button class="button create small float-right" type="submit" (click)="saveMarkPaidDetails(paidBill)" data-close>Submit</button>
                    </div>
                  </div>
                </section>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>
  <div class="reveal tiny bill-modal-container" id="bill-password-conformation" data-reveal foundation  data-close-on-click="false">
    <label>Enter Password
      <input type="password" [(ngModel)]="key"  placeholder="Password*">
    </label>
    <div class="text-right">
      <button class="button small" [disabled]="!checkValidation()" (click)="validateLockKey()">Submit</button>
      <button class="button small" (click)="closePasswordConfirmation()">Cancel</button>
    </div>
  </div>
</div>
