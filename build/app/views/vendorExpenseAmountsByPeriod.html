<style>
  @media print {
    #report-tabs{
      display: none !important;
    }
  }
  table{
    margin-top: 30px;
    border: 1px solid #f1f1f1;
    width: 100%;
  }
  thead{
    background: none;
  }
  th{
    color: #878787;
    font-size: 15px;
  }
  tr{
    height: 36px;
  }
  td, th{
    border-bottom: 1px solid #DCDEDD;
  }
  .header{
    color: #282895;
    text-align: center;
  }
  .company-name{
    font-weight: 800;
    font-size: 20px;
  }
  .report-name{
    font-size: 18px;
  }
  .criteria{
    font-size: 16px;
  }
</style>
<div>
  <div class="report-wrapper" foundation [hidden]="!allSections.showReportForm">

    <report-search-criteria [reportName]="'Bills and Payments Summary'" [reportDesc]="'Provides summary of bills, credits payments types with vendor and period level information.'"
                            [hideReportForm]="!allSections.showReportForm" [setReportType]="'vendorSummary'" id="WrappedDetails"></report-search-criteria>
  </div>

  <div class="reports" *ngIf="allSections.showTabber">
    <ul class="reports tabs" data-tabs id="report-tabs">
      <li class="reports tabs-title" [ngClass]="{'is-active': isTabActive('summary')==true}"><a id="a-summary"(click)="setActiveTab('summary')" aria-selected="true"><h6>Summary</h6></a></li>
      <li class="reports tabs-title" [ngClass]="{'is-active': isTabActive('detailReport')==true}"><a id="a-detailReport" (click)="setActiveTab('detailReport')"><h6>Detail Report</h6></a></li>
    </ul>
    <div class="reports tabs-content" data-tabs-content="report-tabs">
      <div class="reports tabs-panel is-active" *ngIf="isTabActive('summary')" id="summary">
        <div class="row chart-margin">
          <div class="column medium-12 small-12 charts-main report-stats-padding" style="min-width: 300px;height:300px;">
            <high-chart *ngIf="reportChartOptions" [options]="reportChartOptions"></high-chart>
          </div>
        </div>
      </div>
      <div class="reports tabs-panel is-active" *ngIf="isTabActive('detailReport')" id="detailReport">
        <div class="float-right icons report-icon-header">
          <i class="icon ion-ios-email-outline" (click)="openemail()"></i>
          <i class="icon ion-ios-cloud-download-outline" data-toggle="export-dropdown"></i>
          <div class="dropdown-pane bottom" id="export-dropdown" data-dropdown data-hover="true" data-hover-pane="true" foundation>
            <div (click)="exportToExcel()" class="export-option">Export To Excel</div>
            <div (click)="exportToPDF()" class="export-option">Export To PDF</div>
          </div>
          <i class="icon ion-ios-printer-outline" (click)="printDiv()"></i>
        </div>
        <div id="numeric">
          <div class="display-report" *ngIf="isSuccess">
            <div class="text-center">
              <div [ngClass]="customObj.customizations.headerAlignment" class="print-mode">
                <div class="header company-name">{{companyName}}</div>
                <div class="header report-name">{{reportName}}</div>
                <div class="header criteria" *ngIf="customObj.customizations.includeReportPeriod">
                  As of {{reportPeriod}}
                </div>
              </div>
              <table class="payments-table">
                <thead>
                <tr>
                  <th></th>
                  <th></th>
                  <th *ngFor="let column of columns">{{column}}</th>
                </tr>
                </thead>
                <tbody>
                <template ngFor [ngForOf]="results" let-res="$implicit">
                  <tr>
                    <td >{{res.payments.vendorID}}</td>
                    <td>Payments</td>
                    <td *ngFor="let column of columns;let j=index" [ngClass]="{red: isNegativeValue(res.payments[column])}">
                      <span *ngIf="res.payments[column]!=0" class="report-cell-value" (click)="showReportDetails(column,res.payments,false,'payments')">{{res.payments[column]}}</span>
                      <span *ngIf="res.payments[column]==0" style="color: #000000">{{res.payments[column]}}</span>
                    </td>
                  </tr>
                  <tr>
                    <td>{{res.payables.vendorID}}</td>
                    <td>Payables</td>
                    <td *ngFor="let column of columns;let j=index" [ngClass]="{red: isNegativeValue(res.payables[column])}">
                      <span *ngIf="res.payables[column]!=0" class="report-cell-value" (click)="showReportDetails(column,res.payables,false,'payables')">{{res.payables[column]}}</span>
                      <span *ngIf="res.payables[column]==0" style="color: #000000">{{res.payables[column]}}</span>
                    </td>
                  </tr>
                </template>
                </tbody>
              </table>
              <footer [ngClass]="customObj.customizations.footerAlignment">
                <span *ngIf="customObj.customizations.includeDatePrepared">{{datePrepared}}</span>
                <span *ngIf="customObj.customizations.includeTimePrepared">{{timePrepared}}</span>
              </footer>
            </div>
          </div>
          <div class="columns report-failure" *ngIf="isFailure">
            <div style="text-align: center;padding-top: 10px;">
              <div class="failure-text">This report does not contain any data.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="allSections.showBills">
    <h4>Bills Details</h4>
    <table>
      <thead>
      <tr>
        <th>Bill Number</th>
        <th>Company</th>
        <th>Vendor</th>
        <th>Bill Amount</th>
        <th>Due Date</th>
        <th>State</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let bill of billsList;let i=index" style="cursor:pointer;" (click)="goTOBillDetailsPage(bill)">
        <td>{{bill.billID}}</td>
        <td>{{bill.companyName}}</td>
        <td>{{bill.vendorName}}</td>
        <td>{{bill.amount|currency:bill.currency:true:'1.2-2'}}</td>
        <td>{{bill.dueDate}}</td>
        <td>{{bill.currentState}}</td>
      </tr>
      </tbody>
    </table>
    <button class="close-button" data-close aria-label="Close modal" type="button">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>


  <div class="reveal medium bill-modal-container" #reportMail id="EmailModal" style="width: 900px;height:700px;" data-reveal data-close-on-click="false" data-animation-in="ease-in" data-animation-out="ease-out">
    <form (ngSubmit)="doEmail($event)" novalidate [formGroup]="emailForm">
      <div class="row">
        <div style="font-size: larger;font-weight: 800">Email Report</div>
      </div>
      <div class="row">
        <pre><label for="ToAddress" style="font-weight: 700;margin-top: 20px;">To    </label><br /></pre>
        <div class="small-16 columns" style="margin-top: 20px;">
          <input formControlName="Toaddress" id="Toaddress" [tagsList]="[]" class="bighalf-tags,input, empty" name="name" type="text" value="" size="30" custom-tags /><br />
        </div>
      </div>
      <div class="row" *ngIf="showEmail">
        <pre><label for="cc" style="font-weight: 700">CC    </label><br /></pre>
        <div class="small-16 columns">
          <input formControlName="cc" id="cc" [tagsList]="emailAddress"  class="bighalf-tags,input, empty" name="email" type="text" size="30" custom-tags /><br />
        </div>
      </div>
      <div class="row">
        <pre><label for="Emailsubject" style="font-weight: 700">Subject</label><br /></pre>
        <div class="small-16 columns">
          <input formControlName="Emailsubject" id="Emailsubject" class="input" name="email" type="text" value="Your Vendor Expense By Expense Period Report" size="30" /><br />
        </div>
      </div>
      <div class="row">
        <pre><label style="font-weight: 700">Body   </label><br /></pre>
        <div class="small-16 columns">
          <textarea formControlName="EmailBody" rows="7" cols="50"  id="EmailBody">
            Hello, &#13;&#10;
            Attached is Vendor Expense By Expense Period Report &#13;&#10;
            Regards,&#13;&#10;
            {{user.first_name}} {{user.last_name}}
          </textarea><br />
        </div>
      </div>
      <div class="row">
        <pre><label for="report" style="font-weight:bolder">Report </label><br /></pre>
        <div class="small-16 columns">
          <input id="report" class="input" name="Report" type="text" value="Vendor Expense By Expense Period report" size="30" /><br />
        </div>
      </div>
      <!--<button id="cancel_button" class="button" data-close aria-label="Close modal" style="float: left" >Cancel</button>-->
      <button class="button" style="float: right;" type="submit" data-close>Send</button>
    </form>
    <button class="close-button" data-close aria-label="Close reveal" type="button">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>

</div>
