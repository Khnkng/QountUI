<style>
    table{
        margin-top: 30px;
        border: 1px solid #f1f1f1;
        width: 100%;
    }
    thead{
        background: none;
    }
    th{
        color: #878787;
        font-size: 15px;
    }
    tr{
        height: 36px;
    }
    td, th{
        border-bottom: 1px solid #DCDEDD;
    }
    .header{
        color: rgb(40, 40, 149);
        text-align: center;
    }
    .company-name{
        font-weight: 800;
        font-size: 20px;
    }
    .report-name{
        font-size: 18px;
    }
    .criteria{
        font-size: 16px;
    }
    .text-left{
        text-align: left;
    }
    .text-right{
        text-align: right;
        padding-right: 10px;
    }
    td.group{
        padding-left: 25px;
    }
    td.type{
        padding-left: 50px;
    }
    td.subtype{
        padding-left: 75px;
    }
    td.coa-child-1{
        padding-left: 100px;
    }
    td.coa-child-2{
        padding-left: 125px;
    }
    td.coa-child-3{
        padding-left: 150px;
    }
    td.coa-child-4{
        padding-left: 175px;
    }
    td.coa-child-5{
        padding-left: 200px;
    }
    .heading-color{
        color: #808CC5;
        font-weight: 700;
    }
    .total-color{
        color: #00B1A9;
        font-weight: 700;
    }
</style>
<div foundation class="balance-sheet">

    <div class="report-wrapper" id="WrappedDetails" [hidden]="!allSections.showReportForm">
        <report-search-criteria [reportName]="'Balance Sheet'" [reportDesc]="'Balance Sheet.'"
                                [hideReportForm]="!allSections.showReportForm" [setReportType]="'balanceSheet'"></report-search-criteria>
    </div>


    <div class="reports" *ngIf="allSections.showTabber">
        <ul class="reports tabs" data-tabs id="report-tabs">
            <li class="reports tabs-title" [ngClass]="{'is-active': isTabActive('summary')==true}"><a id="a-summary"(click)="setActiveTab('summary')" aria-selected="true"><h6>Dashboard</h6></a></li>
            <li class="reports tabs-title" [ngClass]="{'is-active': isTabActive('detailReport')==true}"><a id="a-detailReport" (click)="setActiveTab('detailReport')"><h6>Detail Report</h6></a></li>
        </ul>
        <div class="reports tabs-content" data-tabs-content="report-tabs">
            <div class="reports tabs-panel is-active" *ngIf="isTabActive('summary')" id="summary">
                <div class="row income-charts">
                    <div class="column medium-8 small-12" style="padding-left: 0">
                        <div class="row chart-margin">
                            <div class="column medium-3 small-6 report-stats-padding">
                                <div class="text-center income-stats" [ngStyle]="{'background-color': incomeStatsColors[0]}">
                                    <div>RETURN ON EQUITY</div>
                                    <div>{{result.metrics.returnOnEquity}}</div>
                                </div>
                            </div>
                            <div class="column medium-3 small-6 report-stats-padding">
                                <div class="text-center income-stats" [ngStyle]="{'background-color': incomeStatsColors[1]}">
                                    <div>DEBIT EQUITY RATIO</div>
                                    <div>{{result.metrics.debtToEquityRatio}}</div>
                                </div>
                            </div>
                            <div class="column medium-3 small-6 report-stats-padding">
                                <div class="text-center income-stats" [ngStyle]="{'background-color': incomeStatsColors[2]}">
                                    <div>CURRENT RATIO</div>
                                    <div>{{result.metrics.currentRatio}}</div>
                                </div>
                            </div>
                            <div class="column medium-3 small-6 report-stats-padding">
                                <div class="text-center income-stats" [ngStyle]="{'background-color': incomeStatsColors[3]}">
                                    <div>QUICK RATIO</div>
                                    <div>{{result.metrics.quickRatio}}</div>
                                </div>
                            </div>
                        </div>

                        <div class="row chart-margin">
                            <div class="column medium-12 small-12 charts-main report-stats-padding" style="min-width: 300px;height:300px;">
                                <template [ngIf]="hasCurrentRatioData">
                                    <high-chart #hChart1=highChart [options]="currentRatioDataOptions"></high-chart>
                                </template>
                            </div>
                        </div>
                        <div class="row">
                            <div class="column medium-12 detailed-chart-icons">
                                <template [ngIf]="hasCurrentRatioData">
                                    <span class="text-right float-right" (click)="showOtherCharts('currentRatioTrend')"><i class="icon icon ion-arrow-expand" [ngClass]="detailedChartIcons"></i></span>
                                </template>
                            </div>
                        </div>

                        <div class="row chart-margin" style="border-top:1px solid #e1e1e1;">
                            <div class="column medium-6 charts-main report-stats-padding" style="min-width: 300px;height:300px; border-right:1px solid #e1e1e1;padding-top:20px;">
                                <template [ngIf]="hasTotalAssetsTrendData">
                                    <high-chart #hChart2=highChart [options]="totalAssetsTrendOptions"></high-chart>
                                </template>
                            </div>
                            <div class="column medium-6 charts-main report-stats-padding" style="min-width: 300px;height:300px;padding-top:20px;">
                                <template [ngIf]="hasLiabilitiesCompositionData">
                                    <high-chart #hChart3=highChart [options]="groupedLiabilitiesCompOptions"></high-chart>
                                </template>
                            </div>
                        </div>
                        <div class="row">
                            <div class="column medium-6 detailed-chart-icons">
                                <template [ngIf]="hasTotalAssetsTrendData">
                                    <span class="text-right float-right" (click)="showOtherCharts('totalAssetsChart')"><i class="icon icon ion-arrow-expand" [ngClass]="detailedChartIcons"></i></span>
                                </template>
                            </div>
                            <div class="column medium-6 detailed-chart-icons">
                                <template [ngIf]="hasLiabilitiesCompositionData">
                                    <span class="text-right float-right" (click)="showOtherCharts('liabilitiesComposition')"><i class="icon icon ion-arrow-expand" [ngClass]="detailedChartIcons"></i></span>
                                </template>
                            </div>
                        </div>
                    </div>
                    <div class="column medium-4 small-12 chart-margin income-statement-stats">
                        <div class="text-center">Balance Sheet</div>
                        <div>
                            <span>Assets</span>
                            <span class="float-right">
                                <span class="pointer">
                                    {{getTotal(result, 'Assets', 'total')}}
                                </span>
                            </span>
                        </div>
                        <div class="row bsheet-group">
                            <div class="column medium-12" [ngClass]="catTotal.class" *ngFor="let catTotal of getCategories(result, 'Assets')">
                                <span>{{catTotal.displayName}}</span>
                                <span class="float-right"><span>{{catTotal.value}}</span></span>
                            </div>
                        </div>
                        <hr class="incomeSeparator">
                        <div>
                            <span>Liabilities & Equity</span>
                            <span class="float-right">
                                <span class="pointer">
                                    {{getTotal(result, 'Equity & Liabilities', 'total')}}
                                </span>
                            </span>
                        </div>
                        <div>
                            <span>Liabilities</span>
                            <span class="float-right">
                                <span class="pointer">
                                    {{getTotal(result['Equity & Liabilities'], 'Liabilities', 'total')}}
                                </span>
                            </span>
                        </div>
                        <div class="row bsheet-group">
                            <div class="column medium-12" [ngClass]="catTotal.class" *ngFor="let catTotal of getCategories(result['Equity & Liabilities'], 'Liabilities')">
                                <span>{{catTotal.displayName}}</span>
                                <span class="float-right"><span>{{catTotal.value}}</span></span>
                            </div>
                        </div>
                        <div>
                            <span>Equity</span>
                            <span class="float-right">
                                <span class="pointer">
                                    {{getTotal(result['Equity & Liabilities'], 'Equity', 'total')}}
                                </span>
                            </span>
                        </div>
                        <div class="row bsheet-group">
                            <div class="column medium-12 level2" *ngFor="let coa of result['Equity & Liabilities']['Equity'].data">
                                <span>{{coa["COA Name"]}}</span>
                                <span class="float-right"><span>{{getFormattedAmount(coa["Amount"])}}</span></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="reports tabs-panel is-active" *ngIf="isTabActive('detailReport')" id="detailReport">
                <div class="float-right icons report-icon-header">
                    <i class="icon ion-ios-email-outline" (click)="openemail()"></i>
                    <i class="icon ion-ios-cloud-download-outline" data-toggle="export-dropdown"></i>
                    <div class="dropdown-pane bottom" id="export-dropdown" data-dropdown data-hover="true" data-hover-pane="true" foundation>
                        <div (click)="exportToExcel()" class="export-option">Export To Excel</div>
                        <div (click)="exportToPDF()" class="export-option">Export To PDF</div>
                    </div>
                    <i class="icon ion-ios-printer-outline" (click)="printDiv()"></i>
                </div>
                <div id="numeric">
                    <div class="columns display-report" *ngIf="isSuccess">
                        <div>
                            <div [ngClass]="customObj.customizations.headerAlignment" class="print-mode">
                                <div class="header company-name">{{companyName}}</div>
                                <div class="header report-name">{{reportName}}</div>
                                <div class="header criteria" *ngIf="customObj.customizations.includeReportPeriod">
                                    As of {{reportPeriod}}
                                </div>
                            </div>
                            <table class="balance-sheet-table report-table">
                                <thead>
                                <tr>
                                    <th colspan="4" class="text-center">COA Name</th>
                                    <th class="text-center">Amount</th>
                                </tr>
                                </thead>
                                <tbody>
                                <template ngFor [ngForOf]="result.rows" let-category="$implicit">
                                    <tr>
                                        <td colspan="5" class="text-left heading-color">{{category}}</td>
                                    </tr>
                                    <template ngFor [ngForOf]="result[category].rows" let-group="$implicit">
                                        <tr>
                                            <td class="group text-left heading-color" colspan="5">{{group}}</td>
                                        </tr>
                                        <template [ngIf]="group != 'Equity'">
                                            <template ngFor [ngForOf]="result[category][group].rows" let-type="$implicit">
                                                <tr>
                                                    <td class="type text-left heading-color" colspan="5">{{type}}</td>
                                                </tr>
                                                <template [ngIf]="!result[category][group][type].rows">
                                                    <template ngFor [ngForOf]="sortChartOfAccounts(result[category][group][type].data)" let-coa="$implicit">
                                                        <tr class="pointer" *ngIf="!coa.isTotal" (click)="filterJournals(coa['Coa ID'])">
                                                            <td class="text-left {{coa.class}}" colspan="4">{{coa["COA Name"]}}</td>
                                                            <td class="text-right">{{getFormattedAmount(coa["Amount"])}}</td>
                                                        </tr>
                                                        <tr *ngIf="coa.isTotal">
                                                            <td class="text-left {{coa.class}}" colspan="4">{{coa["COA Name"]}}</td>
                                                            <td class="text-right">{{getFormattedAmount(coa["Amount"])}}</td>
                                                        </tr>
                                                    </template>
                                                    <tr>
                                                        <td class="type total-color text-left" colspan="4">Total {{type}}</td>
                                                        <td class="text-right total-color">{{getFormattedAmount(result[category][group][type].total)}}</td>
                                                    </tr>
                                                </template>
                                                <template [ngIf]="result[category][group][type].rows">
                                                    <template ngFor [ngForOf]="result[category][group][type].rows" let-subtype="$implicit">
                                                        <tr>
                                                            <td class="subtype text-left heading-color" colspan="5">{{subtype}}</td>
                                                        </tr>
                                                        <template [ngIf]="!result[category][group][type][subtype].rows">
                                                            <template ngFor [ngForOf]="sortChartOfAccounts(result[category][group][type][subtype].data)" let-coa="$implicit">
                                                                <tr class="pointer" *ngIf="!coa.isTotal" (click)="filterJournals(coa['Coa ID'])">
                                                                    <td class="text-left {{coa.class}}" colspan="4">{{coa["COA Name"]}}</td>
                                                                    <td class="text-right">{{getFormattedAmount(coa["Amount"])}}</td>
                                                                </tr>
                                                                <tr *ngIf="coa.isTotal">
                                                                    <td class="text-left {{coa.class}}" colspan="4">{{coa["COA Name"]}}</td>
                                                                    <td class="text-right">{{getFormattedAmount(coa["Amount"])}}</td>
                                                                </tr>
                                                            </template>
                                                            <tr>
                                                                <td class="subtype total-color text-left" colspan="4">Total {{subtype}}</td>
                                                                <td class="text-right total-color">{{getFormattedAmount(result[category][group][type][subtype].total)}}</td>
                                                            </tr>
                                                        </template>
                                                        <template [ngIf]="result[category][group][type][subtype].rows">
                                                            <template ngFor [ngForOf]="result[category][group][type][subtype].rows" let-child="$implicit">
                                                                <tr>
                                                                    <td class="coa-child-1 text-left heading-color" colspan="5">{{child}}</td>
                                                                </tr>
                                                                <template ngFor [ngForOf]="sortChartOfAccounts(result[category][group][type][subtype][child].data, child)" let-coa="$implicit">
                                                                    <tr class="pointer" *ngIf="!coa.isTotal" (click)="filterJournals(coa['Coa ID'])">
                                                                        <td class="text-left {{coa.class}}" colspan="4">{{coa["COA Name"]}}</td>
                                                                        <td class="text-right">{{getFormattedAmount(coa["Amount"])}}</td>
                                                                    </tr>
                                                                    <tr *ngIf="coa.isTotal">
                                                                        <td class="text-left {{coa.class}}" colspan="4">{{coa["COA Name"]}}</td>
                                                                        <td class="text-right">{{getFormattedAmount(coa["Amount"])}}</td>
                                                                    </tr>
                                                                </template>
                                                                <tr>
                                                                    <td class="coa-child-1 total-color text-left" colspan="4">Total {{child}}</td>
                                                                    <td class="text-right total-color">{{getFormattedAmount(result[category][group][type][subtype][child].total)}}</td>
                                                                </tr>
                                                            </template>
                                                        </template>
                                                    </template>
                                                </template>
                                            </template>
                                        </template>
                                        <template [ngIf]="group == 'Equity'">
                                            <template ngFor [ngForOf]="result[category][group].data" let-coa="$implicit">
                                                <tr class="pointer" *ngIf="!coa.isTotal" (click)="filterJournals(coa['Coa ID'])">
                                                    <td class="type text-left" colspan="4">{{coa["COA Name"]}}</td>
                                                    <td class="text-right">{{getFormattedAmount(coa["Amount"])}}</td>
                                                </tr>
                                                <tr *ngIf="coa.isTotal">
                                                    <td class="text-left {{coa.class}}" colspan="4">{{coa["COA Name"]}}</td>
                                                    <td class="text-right">{{getFormattedAmount(coa["Amount"])}}</td>
                                                </tr>
                                            </template>
                                        </template>
                                        <tr>
                                            <td class="group total-color text-left" colspan="4">Total {{group}}</td>
                                            <td class="text-right total-color">{{getFormattedAmount(result[category][group].total)}}</td>
                                        </tr>
                                    </template>
                                    <tr>
                                        <td class="total-color" colspan="4">Total {{category}}</td>
                                        <td class="text-right total-color">{{getFormattedAmount(result[category].total)}}</td>
                                    </tr>
                                </template>
                                </tbody>
                            </table>
                            <footer [ngClass]="customObj.customizations.footerAlignment">
                                <span *ngIf="customObj.customizations.includeDatePrepared">{{datePrepared}}</span>
                                <span *ngIf="customObj.customizations.includeTimePrepared">{{timePrepared}}</span>
                            </footer>
                        </div>
                    </div>
                    <div class="columns report-failure" *ngIf="isFailure">
                        <div>
                            <h4 class="report-heading">{{companyName}}</h4>
                            <h5 class="report-heading">Trail Balance Report</h5>
                            <h6 class="report-heading">As of {{displayDate}}</h6>
                            <div class="failure-text">This report does not contain any data.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row expanded chart-margin" *ngIf="allSections.showExpandChart">
        <div class="column medium-12 expanded charts-main">
            <div style="min-width: 600px;height: calc(100vh - 150px);">
                <high-chart  *ngIf="showDetailedChart" #hChart4=highChart [options]="detailedReportChartOptions"></high-chart>
            </div>
        </div>
    </div>

    <div foundation class="column large-12 medium-12 small-12 foo-container chart_search chart-margin" *ngIf="allSections.showJournals">
        <foo-table #fooTableDir="fooTable" *ngIf="hasJornalDetailedData" class="bighalf-footable hide-pagination" [data]="journaldetailedtableData" [options]="journaldetailedtableOptions" (onRowClick)="goToJournalEntry($event)"></foo-table>
    </div>

    <div class="reveal medium bill-modal-container" #reportMail id="EmailModal" style="width: 900px;height:700px;" data-reveal data-close-on-click="false" data-animation-in="ease-in" data-animation-out="ease-out">
        <form (ngSubmit)="doEmail($event)" novalidate [formGroup]="emailForm">
            <div class="row">
                <div style="font-size: larger;font-weight: 800">Email Report</div>
            </div>
            <div class="row">
                <pre><label for="ToAddress" style="font-weight: 700;margin-top: 20px;">To    </label><br /></pre>
                <div class="small-16 columns" style="margin-top: 20px;">
                    <input formControlName="Toaddress" id="Toaddress" [tagsList]="[]" class="bighalf-tags,input, empty" name="name" type="text" value="" size="30" custom-tags /><br />
                </div>
            </div>
            <div class="row" *ngIf="showEmail">
                <pre><label for="cc" style="font-weight: 700">CC    </label><br /></pre>
                <div class="small-16 columns">
                    <input formControlName="cc" id="cc" [tagsList]="emailAddress"  class="bighalf-tags,input, empty" name="email" type="text" size="30" custom-tags /><br />
                </div>
            </div>
            <div class="row">
                <pre><label for="Emailsubject" style="font-weight: 700">Subject</label><br /></pre>
                <div class="small-16 columns">
                    <input formControlName="Emailsubject" id="Emailsubject" class="input" name="email" type="text" value="Your+'reportName" size="30" /><br />
                </div>
            </div>
            <div class="row">
                <pre><label style="font-weight: 700">Body   </label><br /></pre>
                <div class="small-16 columns">
                    <textarea formControlName="EmailBody" rows="7" cols="50"  id="EmailBody">
                        Hello, &#13;&#10;
                        Attached is {{reportName}} &#13;&#10;
                        Regards,&#13;&#10;
                        {{user.first_name}} {{user.last_name}}
                    </textarea><br />
                </div>
            </div>
            <div class="row">
                <pre><label for="report" style="font-weight:bold;">Report </label><br /></pre>
                <div class="small-16 columns">
                    <input id="report" class="input" name="Report" type="text" value="{{reportName}} report" size="30" /><br />
                </div>
            </div>
            <button class="button" style="float: right;" type="submit" data-close>Send</button>
        </form>
        <button class="close-button" data-close aria-label="Close reveal" type="button">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>

</div>